The code is for the paper "Adaptive Neighborhood Metric Learning", published in IEEE Transactions on Pattern Analysis and Machine Intelligence.

The loss function is in losses/anml.py

If the code helps you, please cite the paper by 

@article{song2021adaptive,
  title={Adaptive neighborhood metric learning},
  author={Song, Kun and Han, Junwei and Cheng, Gong and Lu, Jiwen and Nie, Feiping},
  journal={IEEE Transactions on Pattern Analysis and Machine Intelligence},
  volume={44},
  number={9},
  pages={4591--4604},
  year={2021},
  publisher={IEEE}
}
